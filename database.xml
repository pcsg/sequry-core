<?xml version="1.0" encoding="UTF-8"?>
<database>

    <global>
        <table name="pcsg_gpm_user_keypairs" no-auto-update="1" no-site-reference="1">
            <field type="BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY">id</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">userId</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">authPluginId</field>
            <field type="BLOB NOT NULL">publicKey</field>
            <field type="BLOB NOT NULL">privateKey</field>
            <field type="BLOB NOT NULL">MAC</field>
            <primary>id</primary>
        </table>

        <table name="pcsg_gpm_user_data_access" no-auto-update="1" no-site-reference="1">
            <field type="BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY">id</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">userId</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">dataId</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">keyPairId</field>
            <field type="BLOB NOT NULL">dataKey</field>
            <field type="BLOB NOT NULL">MAC</field>
            <primary>id</primary>
        </table>

        <table name="pcsg_gpm_password_data" no-auto-update="1" no-site-reference="1">
            <field type="BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY">id</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">securityClassId</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">ownerId</field>
            <field type="TINYINT(1)">ownerType</field>
            <field type="TEXT NOT NULL">title</field>
            <field type="TEXT">description</field>
            <field type="TEXT NOT NULL">dataType</field>
            <field type="BLOB NOT NULL">cryptoData</field>
            <field type="BLOB NOT NULL">MAC</field>
            <primary>id</primary>
        </table>

        <table name="pcsg_gpm_auth_plugins" no-auto-update="1" no-site-reference="1">
            <field type="BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY">id</field>
            <field type="TEXT NOT NULL">title</field>
            <field type="TEXT">description</field>
            <field type="TEXT NOT NULL">path</field>
            <primary>id</primary>
        </table>

        <table name="pcsg_gpm_security_classes_to_auth_plugins" no-auto-update="1" no-site-reference="1">
            <field type="BIGINT(20) UNSIGNED NOT NULL">securityClassId</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">authPluginId</field>
            <primary>securityClassId,authPluginId</primary>
        </table>

        <table name="pcsg_gpm_security_classes" no-auto-update="1" no-site-reference="1">
            <field type="BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY">id</field>
            <field type="TEXT NOT NULL">title</field>
            <field type="TEXT">description</field>
            <field type="TINYINT(2)">requiredFactors</field>
            <primary>id</primary>
        </table>

        <!-- Groups -->
        <table name="pcsg_gpm_user_group_access" no-auto-update="1" no-site-reference="1">
            <field type="BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY">id</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">userId</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">userKeyPairId</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">groupId</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">securityClassId</field>
            <field type="BLOB NOT NULL">groupKey</field>
            <field type="BLOB NOT NULL">MAC</field>
            <primary>id</primary>
        </table>

        <table name="pcsg_gpm_group_keypairs" no-auto-update="1" no-site-reference="1">
            <field type="BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY">id</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">groupId</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">securityClassId</field>
            <field type="BLOB NOT NULL">publicKey</field>
            <field type="BLOB NOT NULL">privateKey</field>
            <field type="BLOB NOT NULL">MAC</field>
            <primary>id</primary>
        </table>

        <table name="pcsg_gpm_group_data_access" no-auto-update="1" no-site-reference="1">
            <field type="BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY">id</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">groupId</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">dataId</field>
            <field type="BLOB NOT NULL">dataKey</field>
            <field type="BLOB NOT NULL">MAC</field>
            <primary>id</primary>
        </table>

        <!-- Recovery -->
        <table name="pcsg_gpm_recovery" no-auto-update="1" no-site-reference="1">
            <field type="BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY">id</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">userId</field>
            <field type="BIGINT(20) UNSIGNED NOT NULL">authPluginId</field>
            <field type="BLOB NOT NULL">recoveryData</field>
            <field type="BLOB NOT NULL">salt</field>
            <field type="BLOB NOT NULL">MAC</field>
            <primary>id</primary>
        </table>
    </global>

</database>